import{m as N,f as R,h as q,i as U,k as E,d as X,r as k,c as Y,j as l,e as V,L as G,S as J,N as K,A as Q,l as F,b as I}from"./index-Brp6Rsqx.js";import{T as W,a as Z}from"./index-DNuJBaP3.js";import{M as ee}from"./index-DbGz6xAk.js";function M(u){return u===void 0&&(u=""),`.${u.trim().replace(/([\.:!+\/])/g,"\\$1").replace(/ /g,".")}`}function se(u){let{swiper:e,extendParams:T,on:f,emit:C}=u;const m="swiper-pagination";T({pagination:{el:null,bulletElement:"span",clickable:!1,hideOnClick:!1,renderBullet:null,renderProgressbar:null,renderFraction:null,renderCustom:null,progressbarOpposite:!1,type:"bullets",dynamicBullets:!1,dynamicMainBullets:1,formatFractionCurrent:s=>s,formatFractionTotal:s=>s,bulletClass:`${m}-bullet`,bulletActiveClass:`${m}-bullet-active`,modifierClass:`${m}-`,currentClass:`${m}-current`,totalClass:`${m}-total`,hiddenClass:`${m}-hidden`,progressbarFillClass:`${m}-progressbar-fill`,progressbarOppositeClass:`${m}-progressbar-opposite`,clickableClass:`${m}-clickable`,lockClass:`${m}-lock`,horizontalClass:`${m}-horizontal`,verticalClass:`${m}-vertical`,paginationDisabledClass:`${m}-disabled`}}),e.pagination={el:null,bullets:[]};let _,j=0;function A(){return!e.params.pagination.el||!e.pagination.el||Array.isArray(e.pagination.el)&&e.pagination.el.length===0}function $(s,a){const{bulletActiveClass:t}=e.params.pagination;s&&(s=s[`${a==="prev"?"previous":"next"}ElementSibling`],s&&(s.classList.add(`${t}-${a}`),s=s[`${a==="prev"?"previous":"next"}ElementSibling`],s&&s.classList.add(`${t}-${a}-${a}`)))}function L(s,a,t){if(s=s%t,a=a%t,a===s+1)return"next";if(a===s-1)return"previous"}function P(s){const a=s.target.closest(M(e.params.pagination.bulletClass));if(!a)return;s.preventDefault();const t=E(a)*e.params.slidesPerGroup;if(e.params.loop){if(e.realIndex===t)return;const i=L(e.realIndex,t,e.slides.length);i==="next"?e.slideNext():i==="previous"?e.slidePrev():e.slideToLoop(t)}else e.slideTo(t)}function x(){const s=e.rtl,a=e.params.pagination;if(A())return;let t=e.pagination.el;t=N(t);let i,c;const h=e.virtual&&e.params.virtual.enabled?e.virtual.slides.length:e.slides.length,v=e.params.loop?Math.ceil(h/e.params.slidesPerGroup):e.snapGrid.length;if(e.params.loop?(c=e.previousRealIndex||0,i=e.params.slidesPerGroup>1?Math.floor(e.realIndex/e.params.slidesPerGroup):e.realIndex):typeof e.snapIndex<"u"?(i=e.snapIndex,c=e.previousSnapIndex):(c=e.previousIndex||0,i=e.activeIndex||0),a.type==="bullets"&&e.pagination.bullets&&e.pagination.bullets.length>0){const n=e.pagination.bullets;let b,d,y;if(a.dynamicBullets&&(_=U(n[0],e.isHorizontal()?"width":"height"),t.forEach(o=>{o.style[e.isHorizontal()?"width":"height"]=`${_*(a.dynamicMainBullets+4)}px`}),a.dynamicMainBullets>1&&c!==void 0&&(j+=i-(c||0),j>a.dynamicMainBullets-1?j=a.dynamicMainBullets-1:j<0&&(j=0)),b=Math.max(i-j,0),d=b+(Math.min(n.length,a.dynamicMainBullets)-1),y=(d+b)/2),n.forEach(o=>{const p=[...["","-next","-next-next","-prev","-prev-prev","-main"].map(g=>`${a.bulletActiveClass}${g}`)].map(g=>typeof g=="string"&&g.includes(" ")?g.split(" "):g).flat();o.classList.remove(...p)}),t.length>1)n.forEach(o=>{const p=E(o);p===i?o.classList.add(...a.bulletActiveClass.split(" ")):e.isElement&&o.setAttribute("part","bullet"),a.dynamicBullets&&(p>=b&&p<=d&&o.classList.add(...`${a.bulletActiveClass}-main`.split(" ")),p===b&&$(o,"prev"),p===d&&$(o,"next"))});else{const o=n[i];if(o&&o.classList.add(...a.bulletActiveClass.split(" ")),e.isElement&&n.forEach((p,g)=>{p.setAttribute("part",g===i?"bullet-active":"bullet")}),a.dynamicBullets){const p=n[b],g=n[d];for(let B=b;B<=d;B+=1)n[B]&&n[B].classList.add(...`${a.bulletActiveClass}-main`.split(" "));$(p,"prev"),$(g,"next")}}if(a.dynamicBullets){const o=Math.min(n.length,a.dynamicMainBullets+4),p=(_*o-_)/2-y*_,g=s?"right":"left";n.forEach(B=>{B.style[e.isHorizontal()?g:"top"]=`${p}px`})}}t.forEach((n,b)=>{if(a.type==="fraction"&&(n.querySelectorAll(M(a.currentClass)).forEach(d=>{d.textContent=a.formatFractionCurrent(i+1)}),n.querySelectorAll(M(a.totalClass)).forEach(d=>{d.textContent=a.formatFractionTotal(v)})),a.type==="progressbar"){let d;a.progressbarOpposite?d=e.isHorizontal()?"vertical":"horizontal":d=e.isHorizontal()?"horizontal":"vertical";const y=(i+1)/v;let o=1,p=1;d==="horizontal"?o=y:p=y,n.querySelectorAll(M(a.progressbarFillClass)).forEach(g=>{g.style.transform=`translate3d(0,0,0) scaleX(${o}) scaleY(${p})`,g.style.transitionDuration=`${e.params.speed}ms`})}a.type==="custom"&&a.renderCustom?(n.innerHTML=a.renderCustom(e,i+1,v),b===0&&C("paginationRender",n)):(b===0&&C("paginationRender",n),C("paginationUpdate",n)),e.params.watchOverflow&&e.enabled&&n.classList[e.isLocked?"add":"remove"](a.lockClass)})}function S(){const s=e.params.pagination;if(A())return;const a=e.virtual&&e.params.virtual.enabled?e.virtual.slides.length:e.grid&&e.params.grid.rows>1?e.slides.length/Math.ceil(e.params.grid.rows):e.slides.length;let t=e.pagination.el;t=N(t);let i="";if(s.type==="bullets"){let c=e.params.loop?Math.ceil(a/e.params.slidesPerGroup):e.snapGrid.length;e.params.freeMode&&e.params.freeMode.enabled&&c>a&&(c=a);for(let h=0;h<c;h+=1)s.renderBullet?i+=s.renderBullet.call(e,h,s.bulletClass):i+=`<${s.bulletElement} ${e.isElement?'part="bullet"':""} class="${s.bulletClass}"></${s.bulletElement}>`}s.type==="fraction"&&(s.renderFraction?i=s.renderFraction.call(e,s.currentClass,s.totalClass):i=`<span class="${s.currentClass}"></span> / <span class="${s.totalClass}"></span>`),s.type==="progressbar"&&(s.renderProgressbar?i=s.renderProgressbar.call(e,s.progressbarFillClass):i=`<span class="${s.progressbarFillClass}"></span>`),e.pagination.bullets=[],t.forEach(c=>{s.type!=="custom"&&(c.innerHTML=i||""),s.type==="bullets"&&e.pagination.bullets.push(...c.querySelectorAll(M(s.bulletClass)))}),s.type!=="custom"&&C("paginationRender",t[0])}function w(){e.params.pagination=R(e,e.originalParams.pagination,e.params.pagination,{el:"swiper-pagination"});const s=e.params.pagination;if(!s.el)return;let a;typeof s.el=="string"&&e.isElement&&(a=e.el.querySelector(s.el)),!a&&typeof s.el=="string"&&(a=[...document.querySelectorAll(s.el)]),a||(a=s.el),!(!a||a.length===0)&&(e.params.uniqueNavElements&&typeof s.el=="string"&&Array.isArray(a)&&a.length>1&&(a=[...e.el.querySelectorAll(s.el)],a.length>1&&(a=a.find(t=>q(t,".swiper")[0]===e.el))),Array.isArray(a)&&a.length===1&&(a=a[0]),Object.assign(e.pagination,{el:a}),a=N(a),a.forEach(t=>{s.type==="bullets"&&s.clickable&&t.classList.add(...(s.clickableClass||"").split(" ")),t.classList.add(s.modifierClass+s.type),t.classList.add(e.isHorizontal()?s.horizontalClass:s.verticalClass),s.type==="bullets"&&s.dynamicBullets&&(t.classList.add(`${s.modifierClass}${s.type}-dynamic`),j=0,s.dynamicMainBullets<1&&(s.dynamicMainBullets=1)),s.type==="progressbar"&&s.progressbarOpposite&&t.classList.add(s.progressbarOppositeClass),s.clickable&&t.addEventListener("click",P),e.enabled||t.classList.add(s.lockClass)}))}function D(){const s=e.params.pagination;if(A())return;let a=e.pagination.el;a&&(a=N(a),a.forEach(t=>{t.classList.remove(s.hiddenClass),t.classList.remove(s.modifierClass+s.type),t.classList.remove(e.isHorizontal()?s.horizontalClass:s.verticalClass),s.clickable&&(t.classList.remove(...(s.clickableClass||"").split(" ")),t.removeEventListener("click",P))})),e.pagination.bullets&&e.pagination.bullets.forEach(t=>t.classList.remove(...s.bulletActiveClass.split(" ")))}f("changeDirection",()=>{if(!e.pagination||!e.pagination.el)return;const s=e.params.pagination;let{el:a}=e.pagination;a=N(a),a.forEach(t=>{t.classList.remove(s.horizontalClass,s.verticalClass),t.classList.add(e.isHorizontal()?s.horizontalClass:s.verticalClass)})}),f("init",()=>{e.params.pagination.enabled===!1?r():(w(),S(),x())}),f("activeIndexChange",()=>{typeof e.snapIndex>"u"&&x()}),f("snapIndexChange",()=>{x()}),f("snapGridLengthChange",()=>{S(),x()}),f("destroy",()=>{D()}),f("enable disable",()=>{let{el:s}=e.pagination;s&&(s=N(s),s.forEach(a=>a.classList[e.enabled?"remove":"add"](e.params.pagination.lockClass)))}),f("lock unlock",()=>{x()}),f("click",(s,a)=>{const t=a.target,i=N(e.pagination.el);if(e.params.pagination.el&&e.params.pagination.hideOnClick&&i&&i.length>0&&!t.classList.contains(e.params.pagination.bulletClass)){if(e.navigation&&(e.navigation.nextEl&&t===e.navigation.nextEl||e.navigation.prevEl&&t===e.navigation.prevEl))return;const c=i[0].classList.contains(e.params.pagination.hiddenClass);C(c===!0?"paginationShow":"paginationHide"),i.forEach(h=>h.classList.toggle(e.params.pagination.hiddenClass))}});const H=()=>{e.el.classList.remove(e.params.pagination.paginationDisabledClass);let{el:s}=e.pagination;s&&(s=N(s),s.forEach(a=>a.classList.remove(e.params.pagination.paginationDisabledClass))),w(),S(),x()},r=()=>{e.el.classList.add(e.params.pagination.paginationDisabledClass);let{el:s}=e.pagination;s&&(s=N(s),s.forEach(a=>a.classList.add(e.params.pagination.paginationDisabledClass))),D()};Object.assign(e.pagination,{enable:H,disable:r,render:S,update:x,init:w,destroy:D})}const O="https://new-json.onrender.com",z="./icon/";function ie(){const{gameID:u}=X(),[e,T]=k.useState(null),[f,C]=k.useState(null),[m,_]=k.useState({}),[j,A]=k.useState({}),{user:$}=Y(r=>r.userInfo),[L,P]=k.useState(null),[x,S]=k.useState(null),w=async r=>{try{return(await I.get(`${O}/gamesData/${r}`)).data}catch(s){return console.log(s.response.data.errors[0]),null}};k.useEffect(()=>{const r=async()=>{const a=await w(u);a&&T(a);try{const[t,i,c]=await Promise.all([I.get(`${O}/gamesData/${u}/pricesData`),I.get(`${O}/gamesData/${u}/commentsData`),I.get(`${O}/usersData`)]),h=t.data,v=i.data,n=c.data;if(typeof v[0]=="string")_({});else if(typeof v[0]=="object"){const b=n.reduce((y,o)=>(y[o.user_id]=o,y),{}),d=v.map(y=>({comment:y,user:b[y.user_id]}));_(d)}C(h)}catch(t){throw console.log(t.response.data.errors[0]),t}},s=async()=>{const a=await w(Number(u)-1);a&&P(a);const t=await w(Number(u)+1);t&&S(t)};r(),s()},[u]);const D=r=>{A(s=>({...s,[r]:!s[r]}))},H=(r,s=5)=>{const a=[];for(let t=0;t<r;t++)a.push(l.jsx(W,{color:"black"},`filled-${t}`));if(a.length===5)return a;for(let t=r;t<s;t++)a.push(l.jsx(Z,{color:"black"},`empty-${t}`));return a};return e?l.jsxs("div",{className:"game_content position-relative",children:[l.jsxs("div",{className:"info container py-6 py-lg-10",children:[l.jsxs("picture",{children:[l.jsx("source",{media:"(min-width: 992px)"}),l.jsx("img",{className:"w-100 rounded-4",src:e.game_img[0],alt:"banner",style:{maxHeight:"432px",objectFit:"cover"}})]}),l.jsxs("div",{className:"my-6 my-lg-10",children:[l.jsx("h1",{className:"fs-h5 fs-lg-Display2 fw-bold mb-4",children:e.game_name}),l.jsxs("div",{className:"mb-4 d-flex align-items-center",children:[l.jsx("img",{className:"me-1",src:"./icon/star.png",alt:"star"}),l.jsx("p",{className:"fs-Body-2 d-inline border-end border-nature-80 mb-0 me-2 pe-3",children:e.game_score}),l.jsxs("p",{className:"fs-Body-2 mb-0 d-inline",children:[e.game_score_num," 人評論"]})]}),l.jsxs("ul",{className:"d-flex gap-2",children:[l.jsxs("li",{className:"bg-nature-95 text-black px-2 py-1 d-flex align-items-center rounded-pill",children:[l.jsx("span",{className:"material-symbols-outlined me-1",children:"child_care"}),l.jsx("p",{className:"fs-Body-2 mb-0",children:e.game_dif_tagname})]}),l.jsxs("li",{className:"bg-nature-95 text-black px-2 py-1 d-flex align-items-center rounded-pill",children:[l.jsx("span",{className:"material-symbols-outlined me-1",children:"factory"}),l.jsx("p",{className:"fs-Body-2 mb-0",children:e.game_main_tag1name})]}),l.jsxs("li",{className:"bg-nature-95 text-black px-2 py-1 d-flex align-items-center rounded-pill",children:[l.jsx("span",{className:"material-symbols-outlined me-1",children:"editor_choice"}),l.jsx("p",{className:"fs-Body-2 mb-0",children:e.game_main_tag2name})]})]})]}),l.jsxs("div",{className:"row row-cols-1 row-cols-lg-2 gx-6 gy-3",children:[l.jsx("div",{className:"col",children:l.jsxs("div",{className:"border border-nature-70 rounded-4 p-4",children:[l.jsx("h6",{className:"fs-h6 fw-bold text-primary-20 mb-3",children:"基本資訊"}),l.jsxs("ul",{children:[l.jsxs("li",{className:"mb-2 d-flex align-items-center",children:[l.jsx("img",{src:`${z}person.png`,alt:"person",className:"me-3",style:{width:"16px"}}),l.jsxs("p",{className:"fs-Body-2 mb-0 text-break",children:[e.game_minNum_Players," ~ ",e.game_maxNum_Players,"人"]})]}),l.jsxs("li",{className:"mb-2 d-flex align-items-center",children:[l.jsx("img",{src:`${z}time.png`,alt:"time",className:"me-3"}),l.jsxs("p",{className:"fs-Body-2 mb-0 text-break",children:[e.game_time," 分鐘"]})]}),l.jsxs("li",{className:"mb-2 d-flex align-items-center",children:[l.jsx("img",{src:`${z}address.png`,alt:"address",className:"me-3"}),l.jsx("p",{className:"fs-Body-2 mb-0 text-break",children:e.game_address})]}),l.jsxs("li",{className:"mb-2 d-flex align-items-center",children:[l.jsx("img",{src:`${z}link.png`,alt:"link",className:"me-3"}),l.jsx("a",{href:e.game_website,target:"_blank",className:"fs-Body-2 mb-0 text-break",children:e.game_website})]}),l.jsxs("li",{className:"mb-2 d-flex align-items-center",children:[l.jsx("img",{src:`${z}phone.png`,alt:"phone",className:"me-3"}),l.jsx("a",{className:"fs-Body-2 mb-0 text-break",href:`tel:+886${e.game_tel}`,children:e.game_tel})]})]})]})}),l.jsx("div",{className:"col",children:l.jsxs("div",{className:"border border-nature-70 rounded-4 p-4",children:[l.jsx("h6",{className:"fs-h6 fw-bold text-primary-20 mb-3",children:"參考價格"}),l.jsx("ul",{className:"d-flex flex-column gap-2",children:f==null?void 0:f.map(r=>l.jsxs("li",{className:"fs-Body-2",children:[r.price_day_type==="weekday"?"平日":"假日",r.price_people,"：$",r.price_mix]},r.price_id))})]})})]})]}),l.jsx("div",{className:"discribe bg-nature-20",children:l.jsxs("div",{className:"container py-10 py-lg-16 d-flex flex-column align-items-center align-items-lg-start",children:[l.jsxs("div",{className:"title position-relative d-flex flex-column align-items-center align-items-lg-start",children:[l.jsx("h2",{className:"text fs-h6 fs-lg-h3 text-primary-95 fw-bold mb-6",children:"遊戲介紹"}),l.jsx("div",{className:"rectangle bg-nature-30 rounded position-absolute"})]}),l.jsx("p",{className:"d-lg-none text-white text-center mb-11",children:e.game_info}),l.jsx("p",{className:"d-none d-lg-block fs-h6 text-white text-start mb-20",style:{whiteSpace:"pre-line"},children:e.game_info}),l.jsx("div",{className:"comment container px-0",children:l.jsxs("ul",{className:"row row-cols-1 row-cols-md-2 row-cols-lg-3 justify-content-center",children:[Object.keys(m).length>0&&m.map(r=>{const{comment_id:s,coment_content:a,comment_isSpoilered:t,commet_played_time:i,coment_star:c}=r.comment,{user_sex:h,user_name:v}=r.user,n=j[s]??!0;return l.jsxs("li",{className:"comment-item mb-6",children:[l.jsxs("div",{className:"user px-4 mb-2 d-flex align-items-center",children:[l.jsx("img",{className:"image me-3 object-fit-cover rounded-circle",src:h==="男"?"./icon/man.png":h==="女"?"./icon/woman.png":"./icon/user.png",alt:"評論人圖片載入錯誤"}),l.jsx("p",{className:"name text-white fw-bold",children:v})]}),l.jsx("div",{className:"triangle mx-6"}),l.jsxs("div",{className:"content bg-nature-95 rounded-4 p-3 p-lg-5",children:[l.jsxs("div",{className:"mb-3 d-flex justify-content-between align-items-start",children:[l.jsxs("div",{className:"d-flex flex-column align-items-start",children:[l.jsx("p",{className:"date",children:i}),l.jsx("ul",{className:"d-flex gap-2",children:H(c)})]}),l.jsx("p",{className:"tag rounded bg-primary-90 px-2 py-1",children:t?"有劇透":"無劇透"})]}),l.jsx("p",{className:"fs-Body-2",style:{cursor:t?"pointer":"default"},onClick:()=>t&&D(s),children:t&&n?l.jsxs("span",{className:"d-flex align-items-center gap-1",children:[l.jsx(ee,{size:20}),"顯示劇透內容"]}):a})]})]},s)}),l.jsx("li",{className:"comment-item",children:($==null?void 0:$.user_role)==="店家"?"":l.jsxs(G,{to:`/Game_comment/new/${e.game_id}`,className:"add-comment d-flex flex-column justify-content-center align-items-center rounded-4 border-primary-80 text-primary-80",style:{backgroundColor:"#676664",height:"200px",marginTop:"68px",borderStyle:"dashed"},children:[l.jsx("span",{className:"material-symbols-outlined mb-1",style:{fontSize:"2rem"},children:"add_circle"}),l.jsx("p",{className:"",children:Object.keys(m).length===0?"成為第一位評論的人吧！":"分享你的想法"})]})})]})})]})}),l.jsx("div",{className:"join_group",children:l.jsxs("div",{className:"container py-10 py-lg-12 d-flex align-items-center justify-content-center position-relative",children:[l.jsxs("div",{className:"text me-lg-21 me-4",children:[l.jsx("p",{className:"fs-lg-h3 fs-sm-h6 fs-Caption text-nature-30 fw-bold",children:"點擊右側的「揪團去」"}),l.jsx("p",{className:"fs-lg-h3 fs-sm-h6 fs-Caption text-nature-30 fw-bold position-absolute z-2",children:"一起找人解謎吧！"}),l.jsx("div",{className:"rectangle d-none d-sm-block bg-secondary-80 rounded position-absolute z-1"})]}),l.jsx(G,{to:"/TeamBuy",state:{gameId:e.game_id,gameName:e.game_name},children:l.jsxs("picture",{children:[l.jsx("source",{media:"(min-width: 992px)",srcSet:"./illustration/CTA-lg.png"}),l.jsx("img",{src:"./illustration/CTA.png",alt:"CTA-lg"})]})})]})}),l.jsxs("div",{className:"others py-10",children:[l.jsxs("div",{className:"title position-relative d-flex flex-column align-items-center",children:[l.jsx("h2",{className:"text fs-h6 fs-lg-h3 fw-bold mb-7 mb-lg-12",children:"您可能喜歡的遊戲"}),l.jsx("div",{className:"rectangle bg-primary-80 rounded position-absolute"})]}),l.jsx("div",{className:"container",children:L&&x&&l.jsxs(J,{slidesPerView:1,spaceBetween:30,pagination:{clickable:!0},navigation:!0,loop:!0,autoplay:{delay:3e3,disableOnInteraction:!1},modules:[se,K,Q],className:"mySwiper",children:[l.jsx(F,{children:l.jsx(G,{to:`/Game_content/${L.game_id}`,children:l.jsx("img",{className:"image w-100 rounded-3 rounded-lg-8",src:L.game_img[0],alt:L.game_name})})}),l.jsx(F,{children:l.jsx(G,{to:`/Game_content/${x.game_id}`,children:l.jsx("img",{className:"image w-100 rounded-3 rounded-lg-8",src:x.game_img[0],alt:x.game_name})})})]})})]})]}):l.jsx(V,{message:"載入遊戲基本資料中"})}export{ie as default};
